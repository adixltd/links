<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <title>Team Adix — Start</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- PWA basics -->
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#0d6efd" />
    <link rel="apple-touch-icon" href="icon.png" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-title" content="Adix" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />

    <!-- Icons (for guide) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />

    <style>
      :root{
        --brand:#0d6efd;
        --bg: #fbfdff;
        --card:#ffffff;
        --text:#1f2937;
        --muted:#6b7280;
        --border:#ecf0ff;
        --soft:#f6f8ff;
      }
      [data-theme="dark"]{
        --bg:#0a0f1f;
        --card:#0f172a;
        --text:#e5e7eb;
        --muted:#9aa3b2;
        --border:#1f2a44;
        --soft:#0e1731;
      }
      *{box-sizing:border-box}
      html,body{height:100%}
      body{
        margin:0; font-family: system-ui,-apple-system,Segoe UI,Roboto,Inter,Ubuntu,"Helvetica Neue","Noto Sans",sans-serif;
        color:var(--text); background:var(--bg);
        display:flex; align-items:center; justify-content:center; padding:24px;
      }
      .shell{width:100%; max-width:780px}
      .card{
        background:var(--card); border-radius:20px; border:1px solid var(--border);
        box-shadow:0 10px 30px rgba(13,110,253,.08); overflow:hidden;
      }
      .bar{display:flex; align-items:center; justify-content:space-between; padding:16px 18px; border-bottom:1px solid var(--border)}
      .brand{display:flex; align-items:center; gap:12px}
      .brand img{width:40px; height:40px; border-radius:10px; object-fit:contain; background:#fff; border:1px solid var(--border)}
      .brand .name{font-weight:700}
      .mode{
        display:inline-flex; align-items:center; gap:8px; border:1px solid var(--border); background:var(--soft);
        padding:8px 12px; border-radius:999px; cursor:pointer; user-select:none; font-weight:600; color:var(--muted)
      }
      .hero{padding:28px; text-align:center}
      .headline{font-size:1.25rem; font-weight:800; margin:6px 0 4px}
      .sub{color:var(--muted)}
      .btns{display:flex; gap:12px; justify-content:center; flex-wrap:wrap; margin-top:18px}
      .btn{
        border:none; border-radius:12px; padding:12px 18px; font-weight:700; cursor:pointer; display:inline-flex; gap:10px; align-items:center;
        transition:transform .06s ease, box-shadow .2s ease;
      }
      .btn-primary{background:var(--brand); color:#fff; box-shadow:0 6px 16px rgba(13,110,253,.28)}
      .btn-primary:hover{transform:translateY(-1px)}
      .btn-outline{background:transparent; color:var(--brand); border:1px solid rgba(13,110,253,.35)}
      .section{padding:18px 22px 24px; border-top:1px solid var(--border)}
      details{border:1px dashed var(--border); border-radius:14px; padding:14px; background:var(--soft); margin-top:10px}
      summary{cursor:pointer; list-style:none; display:flex; gap:10px; align-items:center; font-weight:700}
      summary::-webkit-details-marker{display:none}
      .steps{margin:10px 0 2px; padding-left:18px; color:var(--text)}
      .steps li{margin:.35rem 0}
      .foot{color:var(--muted); font-size:.9rem; text-align:center; margin-top:12px}
      .pill{display:inline-flex; align-items:center; gap:8px; border:1px dashed var(--border); padding:6px 10px; border-radius:999px; background:var(--soft); color:var(--muted); font-weight:600}
      .small-logo{width:18px; height:18px; border-radius:4px; object-fit:contain; background:#fff}
      a.inline{color:var(--brand); text-decoration:none; font-weight:600}
    </style>
  </head>
  <body>
    <div class="shell">
      <div class="card">
        <div class="bar">
          <div class="brand">
            <img src="https://raw.githubusercontent.com/adixltd/adix-assets/main/ADIX%20LOGO%20V5.01%20192.png" alt="Adix" />
            <div class="name">Team Adix</div>
          </div>
          <button id="modeBtn" class="mode" type="button">
            <i class="bi bi-brightness-high-fill"></i><span>Light</span>
          </button>
        </div>

        <div class="hero">
          <div class="pill">
            <img class="small-logo" src="icon.png" alt="App Icon" />
            Save to Home Screen for 1-tap access
          </div>
          <div class="headline">Welcome! Ready to continue?</div>
          <div class="sub">Tap <strong>Proceed</strong> to open the staff app. You can also install it on your home screen.</div>
          <div class="btns">
            <!-- Also provide a real anchor as fallback -->
            <a id="proceedLink" class="btn btn-primary" href="#" rel="noopener" target="_self">
              <i class="bi bi-arrow-right-circle-fill"></i> Proceed to App
            </a>
            <button id="installBtn" class="btn btn-outline" type="button" hidden>
              <i class="bi bi-plus-circle"></i> Install App
            </button>
          </div>
        </div>

        <div class="section">
          <details id="androidGuide" open>
            <summary><i class="bi bi-android2"></i> Add to Home Screen on <strong>Android (Chrome)</strong></summary>
            <ol class="steps">
              <li>Tap the <strong>⋮</strong> menu (top-right) in Chrome.</li>
              <li>Choose <strong>Add to Home screen</strong> or <strong>Install app</strong>.</li>
              <li>Confirm by tapping <strong>Add</strong>/<strong>Install</strong>. You’ll get the Adix icon on your home screen.</li>
            </ol>
          </details>

          <details id="iosGuide">
            <summary><i class="bi bi-apple"></i> Add to Home Screen on <strong>iPhone / iPad (Safari)</strong></summary>
            <ol class="steps">
              <li>Open this page in <strong>Safari</strong>.</li>
              <li>Tap the <strong>Share</strong> button <i class="bi bi-box-arrow-up"></i>.</li>
              <li>Select <strong>Add to Home Screen</strong>, then tap <strong>Add</strong>.</li>
            </ol>
            <div class="sub">Note: iOS only shows “Add to Home Screen” in Safari (not Chrome/Edge).</div>
          </details>

          <div class="foot">After installing, launch from the home screen icon for a full-screen experience.</div>
        </div>
      </div>
    </div>

    <script>
      // -----------------------------
      // Config
      // -----------------------------
      const APP_URL = "https://script.google.com/macros/s/AKfycbw8tcqSQEoUaPUK6ubiES29sAfmjh5tfks3a04VOYb5tXXNxBw36r4AwB0HawIFG96n0A/exec?app=staff";

      // Proceed link uses replace() to avoid "back" ping-pong
      const proceedLink = document.getElementById("proceedLink");
      proceedLink.addEventListener("click", (e) => {
        e.preventDefault();
        window.location.replace(APP_URL);
      });

      // Theme toggle (default light regardless of system)
      const THEME_KEY = "adix-theme";
      const modeBtn = document.getElementById("modeBtn");
      function applyTheme(t){
        document.documentElement.setAttribute("data-theme", t);
        modeBtn.querySelector("span").textContent = t === "dark" ? "Dark" : "Light";
        modeBtn.querySelector("i").className = t === "dark" ? "bi bi-moon-stars-fill" : "bi bi-brightness-high-fill";
      }
      const saved = localStorage.getItem(THEME_KEY) || "light";
      applyTheme(saved);
      modeBtn.addEventListener("click", () => {
        const next = (document.documentElement.getAttribute("data-theme") === "dark") ? "light" : "dark";
        localStorage.setItem(THEME_KEY, next);
        applyTheme(next);
      });

      // Auto-proceed when launched as an installed app OR when URL has ?go=1
      const isStandalone = window.matchMedia && window.matchMedia("(display-mode: standalone)").matches || window.navigator.standalone;
      const urlParams = new URLSearchParams(window.location.search);
      if (isStandalone || urlParams.get("go") === "1") {
        setTimeout(() => { window.location.replace(APP_URL); }, 200);
      }

      // Optional: register a service worker for installability
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker.register("sw.js").catch(()=>{});
      }

      // Chrome PWA install flow (beforeinstallprompt)
      let deferredPrompt = null;
      const installBtn = document.getElementById("installBtn");
      window.addEventListener("beforeinstallprompt", (e) => {
        e.preventDefault();
        deferredPrompt = e;
        installBtn.hidden = false;
      });
      installBtn.addEventListener("click", async () => {
        try {
          if (!deferredPrompt) return;
          deferredPrompt.prompt();
          await deferredPrompt.userChoice;
        } finally {
          installBtn.hidden = true;
          deferredPrompt = null;
        }
      });

      // Open the most relevant guide by default
      (function guide(){
        const ua = navigator.userAgent || navigator.vendor || window.opera;
        const isAndroid = /android/i.test(ua);
        const isIOS = /iphone|ipad|ipod/i.test(ua);
        document.getElementById("androidGuide").open = !!isAndroid;
        document.getElementById("iosGuide").open = !!isIOS;
      })();
    </script>
  </body>
</html>
